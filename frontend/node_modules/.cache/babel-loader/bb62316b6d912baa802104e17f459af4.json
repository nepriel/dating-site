{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/src/components/pages/Dashboard/Home.js\";\nimport React from \"react\";\nimport Header from '../../common/Header';\nimport Sidebar from '../../common/SideBar';\nimport Footer from '../../common/Footer';\nimport SearchBar from './SearchBar';\nimport ResultUser from './ResultUser';\nimport { connect } from \"react-redux\";\nimport { push } from \"react-router-redux\";\nimport { fetchAllUsersPublicData } from '../../../store/actions/UsersActions/fetchAllUsersPublicDataAction';\nimport io from 'socket.io-client';\nimport sort from 'fast-sort';\nimport { GetUserIntrests } from '../../../store/actions/intrestsActions/GetAllInterestsAction';\n\nclass Home extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onChange = async e => {\n      console.log(e.target.value);\n\n      if (e.target.name !== 'sortBy') {\n        e.preventDefault();\n      }\n\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n      setTimeout(async () => {\n        await this.filterUsers();\n      }, 50); // await this.filterUsers();\n      // console.log(this.state[e.target.name]);\n    };\n\n    this.state = {\n      sortBy: 'age',\n      initialUsers: [],\n      interestsArray: [],\n      userBuffer: []\n    };\n    this.onChange = this.onChange.bind(this);\n    this.filterUsers = this.filterUsers.bind(this);\n  }\n\n  async UNSAFE_componentWillMount() {\n    await this.props.onfetchAllUsersPublicData([]);\n    const userId = localStorage.getItem(\"userId\");\n    await this.props.onGetUserIntrests(userId);\n  }\n\n  initUsers(users) {\n    this.setState({\n      initialUsers: users\n    });\n  }\n\n  initInterestArray(interests) {\n    this.setState({\n      interestsArray: interests\n    });\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.getUserInterests !== undefined && nextProps.getUserInterests.code === 200) this.initInterestArray(nextProps.getUserInterests.data);\n    if (nextProps.fetchAllUsersPublicData !== undefined && nextProps.fetchAllUsersPublicData.code === 200) this.initUsers(nextProps.fetchAllUsersPublicData.data);\n  }\n\n  async filterUsers() {\n    let buffer = [];\n    buffer = this.state.initialUsers; // console.log(buffer);\n    //SORT\n    //sort by fame and age\n\n    if (this.state.sortBy === 'fame' || this.state.sortBy === 'age') {\n      buffer = sort(buffer).asc(u => u[this.state.sortBy]);\n      console.log(buffer);\n      this.setState({\n        userBuffer: buffer\n      }); //sort by distance\n    } else if (this.state.sortBy === 'location') {\n      buffer = sort(buffer).asc(u => u.distance); // console.log(buffer);\n\n      this.setState({\n        userBuffer: buffer\n      }); //sort by tags\n    } else if (this.state.sortBy === 'tags') {\n      //on a une liste de tags.\n      //on veut que les utilisateurs qui ont le premier element de la liste de tags arrive en premier puis les deuxieme arrive ensuite\n      var tags = [];\n\n      if (this.state.interestsArray !== null) {\n        this.state.interestsArray.forEach(element => {\n          tags.push(element.value);\n        });\n      }\n\n      var newbuffer = [];\n      tags.forEach(tagfromlist => {\n        buffer.forEach(element => {\n          element.tags.forEach(taguser => {\n            if (taguser === tagfromlist) {\n              newbuffer.push(element);\n            }\n          });\n        });\n      }); // console.log(buffer);\n\n      buffer = newbuffer;\n      this.setState({\n        userBuffer: buffer\n      });\n    }\n  }\n\n  render() {\n    let filteredUsers = this.state.userBuffer;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }), React.createElement(Sidebar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"section\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"section\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }), React.createElement(SearchBar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        padding: '2rem'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        backgroundColor: 'grey',\n        height: '2rem',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \" \", React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"SORT BY\")), React.createElement(\"div\", {\n      style: {\n        backgroundColor: 'grey',\n        height: '5rem',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: somemargin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Age\"), React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"sortBy\",\n      value: \"age\",\n      checked: this.state.sortBy === 'age',\n      onChange: this.onChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: somemargin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Distance\"), React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"sortBy\",\n      value: \"location\",\n      checked: this.state.sortBy === 'location',\n      onChange: this.onChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: somemargin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \"Tags\"), React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"sortBy\",\n      value: \"tags\",\n      checked: this.state.sortBy === 'tags',\n      onChange: this.onChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: somemargin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Fame\"), React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"sortBy\",\n      value: \"fame\",\n      checked: this.state.sortBy === 'fame',\n      onChange: this.onChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    })))), React.createElement(ResultUser, {\n      users: filteredUsers,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }))))), React.createElement(Footer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }));\n  }\n\n}\n\nconst somemargin = {\n  textAlign: 'center',\n  width: '24%'\n};\n\nconst state = (state, ownProps = {}) => {\n  return {\n    fetchAllUsersPublicData: state.fetchAllUsersPublicData.fetchAllUsersPublicData,\n    location: state.location,\n    getUserInterests: state.getUserInterests.getUserInterests\n  };\n};\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    navigateTo: location => {\n      dispatch(push(location));\n    },\n    onGetUserIntrests: userId => dispatch(GetUserIntrests(userId)),\n    onfetchAllUsersPublicData: filter => dispatch(fetchAllUsersPublicData(filter))\n  };\n};\n\nexport default connect(state, mapDispatchToProps)(Home);","map":{"version":3,"sources":["/usr/src/app/src/components/pages/Dashboard/Home.js"],"names":["React","Header","Sidebar","Footer","SearchBar","ResultUser","connect","push","fetchAllUsersPublicData","io","sort","GetUserIntrests","Home","Component","constructor","props","onChange","e","console","log","target","value","name","preventDefault","setState","setTimeout","filterUsers","state","sortBy","initialUsers","interestsArray","userBuffer","bind","UNSAFE_componentWillMount","onfetchAllUsersPublicData","userId","localStorage","getItem","onGetUserIntrests","initUsers","users","initInterestArray","interests","UNSAFE_componentWillReceiveProps","nextProps","getUserInterests","undefined","code","data","buffer","asc","u","distance","tags","forEach","element","newbuffer","tagfromlist","taguser","render","filteredUsers","padding","backgroundColor","height","display","justifyContent","alignItems","somemargin","textAlign","width","ownProps","location","mapDispatchToProps","dispatch","navigateTo","filter"],"mappings":"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","sourcesContent":["\nimport React from \"react\";\nimport Header from '../../common/Header';\nimport Sidebar from '../../common/SideBar';\nimport Footer from '../../common/Footer';\nimport SearchBar from './SearchBar';\nimport ResultUser from './ResultUser';\nimport { connect } from \"react-redux\";\nimport { push } from \"react-router-redux\";\nimport { fetchAllUsersPublicData } from '../../../store/actions/UsersActions/fetchAllUsersPublicDataAction';\nimport io from 'socket.io-client';\nimport sort from 'fast-sort';\nimport { GetUserIntrests } from '../../../store/actions/intrestsActions/GetAllInterestsAction';\n\nclass Home extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            sortBy: 'age',\n            initialUsers: [],\n            interestsArray: [],\n            userBuffer: []\n        }\n\n        this.onChange = this.onChange.bind(this);\n        this.filterUsers = this.filterUsers.bind(this);\n    }\n\n    async UNSAFE_componentWillMount() {\n        await this.props.onfetchAllUsersPublicData([]);\n        const userId = localStorage.getItem(\"userId\");\n        await this.props.onGetUserIntrests(userId);\n    }\n\n    onChange = async (e) => {\n        console.log(e.target.value);\n        if (e.target.name !== 'sortBy'){\n            e.preventDefault();\n        }         \n        this.setState({ [e.target.name]: e.target.value })\n\n        setTimeout(async () => {\n            await this.filterUsers();\n        }, 50);\n        // await this.filterUsers();\n        // console.log(this.state[e.target.name]);\n\n    }\n\n    initUsers(users) {\n        this.setState({\n            initialUsers: users\n        });\n    }\n\n    initInterestArray(interests) {\n        this.setState({\n            interestsArray: interests\n        })\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps) {\n        if (nextProps.getUserInterests !== undefined && nextProps.getUserInterests.code === 200)\n        this.initInterestArray(nextProps.getUserInterests.data)\n        if (nextProps.fetchAllUsersPublicData !== undefined && nextProps.fetchAllUsersPublicData.code === 200)\n            this.initUsers(nextProps.fetchAllUsersPublicData.data);\n    }\n\n\n    async filterUsers () {\n\n        let buffer = [];\n        buffer = this.state.initialUsers;\n        // console.log(buffer);\n\n        //SORT\n        //sort by fame and age\n        if (this.state.sortBy === 'fame' || this.state.sortBy === 'age'){\n            buffer = sort(buffer).asc(u => u[this.state.sortBy]);\n            console.log(buffer);\n            this.setState({\n                userBuffer: buffer\n            })\n        //sort by distance\n        } else if(this.state.sortBy === 'location') {\n            buffer = sort(buffer).asc(u => u.distance);\n            // console.log(buffer);\n            this.setState({\n                userBuffer: buffer\n            })\n        //sort by tags\n        } else if (this.state.sortBy === 'tags') {\n            //on a une liste de tags.\n            //on veut que les utilisateurs qui ont le premier element de la liste de tags arrive en premier puis les deuxieme arrive ensuite\n            var tags = [];\n            if (this.state.interestsArray !== null){\n                this.state.interestsArray.forEach(element => {\n                    tags.push(element.value);\n                });\n            }\n            var newbuffer = [];\n            tags.forEach(tagfromlist => {\n                buffer.forEach(element => {\n                    element.tags.forEach(taguser => {\n                        if(taguser === tagfromlist) {\n                            newbuffer.push(element);\n                        }\n                    });\n                });\n            });\n            // console.log(buffer);\n            buffer = newbuffer;\n            this.setState({\n                userBuffer: buffer\n            })\n        }\n    }\n\n    render() {\n        let filteredUsers = this.state.userBuffer;\n        return (\n            <div>\n                <Header />\n                <Sidebar />\n                <div>\n                    <div className=\"content-wrapper\">\n                        <section className=\"content\">\n\n                            <section className=\"content\">\n                                <br />\n                                <SearchBar />\n                                <div style={{ padding: '2rem' }}>\n                                    <div style={{ backgroundColor: 'grey', height: '2rem', display: 'flex', justifyContent: 'center', alignItems: 'center' }}> <h4>SORT BY</h4></div>\n                                    <div style={{ backgroundColor: 'grey', height: '5rem', display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n                                        <div style={somemargin}>\n                                            <div>Age</div>\n                                            <input type=\"radio\" name=\"sortBy\" value=\"age\" checked={this.state.sortBy === 'age'} onChange={this.onChange} />\n                                        </div>\n                                        <div style={somemargin}>\n                                            <div>Distance</div>\n                                            <input type=\"radio\" name=\"sortBy\" value=\"location\" checked={this.state.sortBy === 'location'} onChange={this.onChange} />\n                                        </div>\n                                        <div style={somemargin}>\n                                            <div>Tags</div>\n                                            <input type=\"radio\" name=\"sortBy\" value=\"tags\" checked={this.state.sortBy === 'tags'} onChange={this.onChange} />\n                                        </div>\n                                        <div style={somemargin}>\n                                            <div>Fame</div>\n                                            <input type=\"radio\" name=\"sortBy\" value=\"fame\" checked={this.state.sortBy === 'fame'} onChange={this.onChange} />\n                                        </div>\n                                    </div>\n\n                                </div>\n                                <ResultUser users={filteredUsers} />\n\n                            </section>\n\n\n                        </section>\n                    </div>\n                </div>\n                <Footer />\n            </div>\n\n        );\n    }\n}\n\nconst somemargin = { textAlign: 'center', width: '24%'}\n\nconst state = (state, ownProps = {}) => {\n    return {\n        fetchAllUsersPublicData: state.fetchAllUsersPublicData.fetchAllUsersPublicData,\n        location: state.location,\n        getUserInterests: state.getUserInterests.getUserInterests,\n    }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n    return {\n        navigateTo: (location) => {\n            dispatch(push(location));\n        },\n        onGetUserIntrests: (userId) => dispatch(GetUserIntrests(userId)),\n        onfetchAllUsersPublicData: (filter) => dispatch(fetchAllUsersPublicData(filter))\n    }\n};\n\nexport default connect(state, mapDispatchToProps)(Home);\n"]},"metadata":{},"sourceType":"module"}