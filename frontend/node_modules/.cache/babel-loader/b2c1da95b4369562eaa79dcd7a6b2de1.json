{"ast":null,"code":"import _regeneratorRuntime from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{useEffect}from\"react\";import{Link}from\"react-router-dom\";import{connect}from\"react-redux\";import{push}from\"react-router-redux\";import{GetCurrentUserInfo}from'../../store/actions/UsersActions/FetchCurrentUserInfoAction';import io from'socket.io-client';var Sidebar=/*#__PURE__*/function(_React$Component){_inherits(Sidebar,_React$Component);function Sidebar(props){var _this;_classCallCheck(this,Sidebar);_this=_possibleConstructorReturn(this,_getPrototypeOf(Sidebar).call(this,props));_this.state={firstname:\"\",socket:io(process.env.REACT_APP_API_URL),lastname:\"\",profilePhoto:\"\",notifCount:0};return _this;}_createClass(Sidebar,[{key:\"UNSAFE_componentWillMount\",value:function(){var _UNSAFE_componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:userId=localStorage.getItem(\"userId\");_context.next=3;return this.props.onGetCurrentUserInfo(userId);case 3:case\"end\":return _context.stop();}}},_callee,this);}));function UNSAFE_componentWillMount(){return _UNSAFE_componentWillMount.apply(this,arguments);}return UNSAFE_componentWillMount;}()},{key:\"getProfilePicture\",value:function getProfilePicture(pictures,state){var pics=[];var i=0;while(i<pictures.length){if(pictures[i].state===state)pics.push(pictures[i].path);i++;}return pics;}},{key:\"initProfileInformation\",value:function initProfileInformation(data){var userInfo=data.info;var profilePhoto=this.getProfilePicture(data.pictures,1);this.setState({firstname:userInfo.firstname,lastname:userInfo.lastname,profilePhoto:profilePhoto.length>0?profilePhoto:\"\"});}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){if(nextProps.getCurrentProfileInfo.data)this.initProfileInformation(nextProps.getCurrentProfileInfo.data);}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var room=localStorage.getItem(\"userId\");this.state.socket.connect(true);this.state.socket.emit('join',room);this.state.socket.on('userNotifications',function(data){_this2.setState({notifCount:data.length});});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.state.socket.disconnect(true);}},{key:\"render\",value:function render(){var image=\"https://mgdetective.ma/wp-content/uploads/2018/05/profile.png\";return React.createElement(\"div\",null,React.createElement(\"aside\",{className:\"main-sidebar\",style:{height:\"1200px\"}},React.createElement(\"section\",{className:\"sidebar\"},React.createElement(\"div\",{className:\"user-panel\"},React.createElement(\"div\",{className:\"pull-left image\"},React.createElement(\"img\",{src:this.state.profilePhoto.toString().substring(0,4)!=='http'?image:process.env.REACT_APP_API_URL+\"/\"+this.state.profilePhoto,className:\"img-circle\",alt:\"User Imag1\"})),React.createElement(\"div\",{className:\"pull-left info\"},React.createElement(\"p\",null,this.state.firstname,\" \",this.state.lastname),React.createElement(\"a\",{href:\"/\"},React.createElement(\"i\",{className:\"fa fa-circle text-success\"}),\" Online\"))),React.createElement(\"form\",{action:\"#\",method:\"get\",className:\"sidebar-form\"},React.createElement(\"div\",{className:\"input-group\"},React.createElement(\"input\",{type:\"text\",name:\"q\",className:\"form-control\",placeholder:\"Search...\"}),React.createElement(\"span\",{className:\"input-group-btn\"},React.createElement(\"button\",{type:\"submit\",name:\"search\",id:\"search-btn\",className:\"btn btn-flat\"},React.createElement(\"i\",{className:\"fa fa-search\"}))))),React.createElement(\"ul\",{className:\"sidebar-menu\",\"data-widget\":\"tree\"},React.createElement(\"li\",{className:\"header\"},\"NAVIGATION PRINCIPALE\"),React.createElement(\"li\",{className:\"active treeview\"},React.createElement(Link,{to:\"/\",onClick:this.props.navigateTo.bind(this,'/')},React.createElement(\"i\",{className:\"fa fa-dashboard\"}),\" \",React.createElement(\"span\",null,\"Dashboard\"))),React.createElement(\"li\",null,React.createElement(Link,{to:\"/profile\",onClick:this.props.navigateTo.bind(this,'/profile')},React.createElement(\"i\",{className:\"fa fa-files-o\"}),React.createElement(\"span\",null,\"Profile\"))),React.createElement(\"li\",null,React.createElement(Link,{to:\"/chat\",onClick:this.props.navigateTo.bind(this,'/chat')},React.createElement(\"i\",{className:\"fa fa-th\"}),\" \",React.createElement(\"span\",null,\"Chat\"),React.createElement(\"span\",{className:\"pull-right-container\"}))),React.createElement(\"li\",null,React.createElement(Link,{to:\"/Notifications\",onClick:this.props.navigateTo.bind(this,'/Notifications')},React.createElement(\"i\",{className:\"fa fa-bell\"}),\" \",React.createElement(\"span\",null,\"Notifications\"),React.createElement(\"span\",{className:\"pull-right-container\"},this.state.notifCount!==0?React.createElement(\"small\",{className:\"label pull-right bg-green\"},this.state.notifCount):\"\"))),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"/Suggestion\"},React.createElement(\"i\",{className:\"fa fa-heart\"}),\" \",React.createElement(\"span\",null,\"Suggestion\")))))));}}]);return Sidebar;}(React.Component);var state=function state(_state){var ownProps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return{getCurrentProfileInfo:_state.getCurrentProfileInfo.getCurrentProfileInfo,location:_state.location};};var mapDispatchToProps=function mapDispatchToProps(dispatch,ownProps){return{navigateTo:function navigateTo(location){dispatch(push(location));},onGetCurrentUserInfo:function onGetCurrentUserInfo(userId){return dispatch(GetCurrentUserInfo(userId));}};};export default connect(state,mapDispatchToProps)(Sidebar);","map":{"version":3,"sources":["/home/abn/my-projects/matcha-42/frontend/src/components/common/SideBar.js"],"names":["React","useEffect","Link","connect","push","GetCurrentUserInfo","io","Sidebar","props","state","firstname","socket","process","env","REACT_APP_API_URL","lastname","profilePhoto","notifCount","userId","localStorage","getItem","onGetCurrentUserInfo","pictures","pics","i","length","path","data","userInfo","info","getProfilePicture","setState","nextProps","getCurrentProfileInfo","initProfileInformation","room","emit","on","disconnect","image","height","toString","substring","navigateTo","bind","Component","ownProps","location","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["\nimport React, {useEffect} from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { push } from \"react-router-redux\";\nimport { GetCurrentUserInfo } from '../../store/actions/UsersActions/FetchCurrentUserInfoAction';\nimport io from 'socket.io-client';\n\nclass Sidebar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      firstname: \"\",\n      socket: io(process.env.REACT_APP_API_URL),\n      lastname: \"\",\n      profilePhoto: \"\",\n      notifCount: 0,\n    }\n  }\n\n  async UNSAFE_componentWillMount() {\n    const userId = localStorage.getItem(\"userId\");\n    await this.props.onGetCurrentUserInfo(userId);\n  }\n\n  getProfilePicture(pictures, state) {\n    let pics = [];\n    let i = 0;\n    while (i < pictures.length) {\n      if (pictures[i].state === state)\n        pics.push(pictures[i].path)\n      i++;\n    }\n\n    return pics;\n  }\n\n  initProfileInformation(data) {\n    let userInfo = data.info;\n    let profilePhoto = this.getProfilePicture(data.pictures, 1);\n\n    this.setState({\n      firstname: userInfo.firstname,\n      lastname: userInfo.lastname,\n      profilePhoto: profilePhoto.length > 0 ? profilePhoto : \"\",\n    })\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.getCurrentProfileInfo.data)\n      this.initProfileInformation(nextProps.getCurrentProfileInfo.data);\n  }\n\n\n  componentDidMount() {\n    let room = localStorage.getItem(\"userId\");\n    this.state.socket.connect(true);\n    this.state.socket.emit('join', room);\n    this.state.socket.on('userNotifications', (data) => {\n      this.setState({\n        notifCount: data.length\n      })\n    })\n  }\n\n  componentWillUnmount() {\n    this.state.socket.disconnect(true);\n  }\n\n  render() {\n    let image = \"https://mgdetective.ma/wp-content/uploads/2018/05/profile.png\"\n    \n\n    return (\n      <div>\n        <aside className=\"main-sidebar\" style={{ height: \"1200px\" }}>\n          <section className=\"sidebar\">\n            <div className=\"user-panel\">\n              <div className=\"pull-left image\">\n                <img src={this.state.profilePhoto.toString().substring(0, 4) !== 'http' ?\n                    image\n                    : process.env.REACT_APP_API_URL + \"/\" + this.state.profilePhoto} className=\"img-circle\" alt=\"User Imag1\" />\n              </div>\n              <div className=\"pull-left info\">\n                <p>{this.state.firstname} {this.state.lastname}</p>\n                <a href=\"/\"><i className=\"fa fa-circle text-success\"></i> Online</a>\n              </div>\n            </div>\n            <form action=\"#\" method=\"get\" className=\"sidebar-form\">\n              <div className=\"input-group\">\n                <input type=\"text\" name=\"q\" className=\"form-control\" placeholder=\"Search...\" />\n                <span className=\"input-group-btn\">\n                  <button type=\"submit\" name=\"search\" id=\"search-btn\" className=\"btn btn-flat\"><i className=\"fa fa-search\"></i>\n                  </button>\n                </span>\n              </div>\n            </form>\n            <ul className=\"sidebar-menu\" data-widget=\"tree\">\n              <li className=\"header\">NAVIGATION PRINCIPALE</li>\n              <li className=\"active treeview\">\n                <Link to=\"/\" onClick={this.props.navigateTo.bind(this, '/')}>\n                  <i className=\"fa fa-dashboard\"></i> <span>Dashboard</span>\n                </Link>\n              </li>\n              <li>\n                <Link to=\"/profile\" onClick={this.props.navigateTo.bind(this, '/profile')}>\n                  <i className=\"fa fa-files-o\"></i>\n                  <span>Profile</span>\n                </Link>\n              </li>\n              <li>\n                <Link to=\"/chat\" onClick={this.props.navigateTo.bind(this, '/chat')}>\n                  <i className=\"fa fa-th\"></i> <span>Chat</span>\n                  <span className=\"pull-right-container\">\n                    {/* <small className=\"label pull-right bg-green\">4</small> */}\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link to=\"/Notifications\" onClick={this.props.navigateTo.bind(this, '/Notifications')}>\n                  <i className=\"fa fa-bell\"></i> <span>Notifications</span>\n                  <span className=\"pull-right-container\">\n                  {this.state.notifCount !== 0 ?\n                    <small className=\"label pull-right bg-green\">\n                      {this.state.notifCount}\n                    </small>: \"\"}\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <a href= {\"/Suggestion\"}>\n                  <i className=\"fa fa-heart\"></i> <span>Suggestion</span>\n                </a>\n              </li>\n            </ul>\n          </section>\n        </aside>\n      </div>\n    );\n  }\n}\n\nconst state = (state, ownProps = {}) => {\n  return {\n    getCurrentProfileInfo: state.getCurrentProfileInfo.getCurrentProfileInfo,\n    location: state.location,\n  }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    navigateTo: (location) => {\n      dispatch(push(location));\n    },\n    onGetCurrentUserInfo: (userId) => dispatch(GetCurrentUserInfo(userId)),\n  }\n};\n\nexport default connect(state, mapDispatchToProps)(Sidebar);"]},"metadata":{},"sourceType":"module"}