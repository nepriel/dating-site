{"ast":null,"code":"import _defineProperty from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/abn/my-projects/matcha-42/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Range}from'rc-slider';import Select from'react-select';import{GetUserIntrests}from'../../../store/actions/intrestsActions/GetAllInterestsAction';import{connect}from\"react-redux\";import{push}from\"react-router-redux\";import ResultUser from'./../Dashboard/ResultUser';import sort from'fast-sort';export var SuggestionList=/*#__PURE__*/function(_Component){_inherits(SuggestionList,_Component);function SuggestionList(props){var _this;_classCallCheck(this,SuggestionList);_this=_possibleConstructorReturn(this,_getPrototypeOf(SuggestionList).call(this,props));_this.onLowerBoundChange=function(e){_this.setState({lowerBound:+e.target.value});};_this.onUpperBoundChange=function(e){_this.setState({upperBound:+e.target.value});};_this.onSliderChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(value){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({value:value});_context.next=3;return _this.filterUsers();case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleApply=function(){var _this$state=_this.state,lowerBound=_this$state.lowerBound,upperBound=_this$state.upperBound;_this.setState({value:[lowerBound,upperBound]});};_this.handleSelectChange=function(selectedOption){_this.setState({selectedOption:selectedOption});setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this.filterUsers();case 2:case\"end\":return _context2.stop();}}},_callee2);})),50);};_this.onChange=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(e.target.name!=='sortBy'){e.preventDefault();}_this.setState(_defineProperty({},e.target.name,e.target.value));setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.filterUsers();case 2:case\"end\":return _context3.stop();}}},_callee3);})),50);// await this.filterUsers();\n// console.log(this.state[e.target.name]);\ncase 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref3.apply(this,arguments);};}();_this.state={sortBy:'age',lowerBound:18,upperBound:75,value:[18,75],SearchBar:'',rangeFame:0,rangeLocalisation:10000,SearchBarTags:'',interestsArray:[],selectedOption:[],location:\"\",initialUsers:_this.props.users,userBuffer:[]};_this.handleUsersFilter=_this.handleUsersFilter.bind(_assertThisInitialized(_this));_this.onChange=_this.onChange.bind(_assertThisInitialized(_this));_this.handleSelectChange=_this.handleSelectChange.bind(_assertThisInitialized(_this));return _this;}_createClass(SuggestionList,[{key:\"handleUsersFilter\",value:function(){var _handleUsersFilter=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e){var filter;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:e.preventDefault();filter=[{userPos:this.state.location,rangeFame:this.state.rangeFame,age:this.state.value,interests:this.state.selectedOption,rangeLocalisation:parseInt(this.state.rangeLocalisation)}];_context5.next=4;return this.props.onfetchAllUsersPublicData(filter);case 4:case\"end\":return _context5.stop();}}},_callee5,this);}));function handleUsersFilter(_x3){return _handleUsersFilter.apply(this,arguments);}return handleUsersFilter;}()},{key:\"UNSAFE_componentWillMount\",value:function(){var _UNSAFE_componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var userId;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:userId=localStorage.getItem(\"userId\");this.setState({interestsArray:this.props.interestsArray});_context6.next=4;return this.props.onGetUserIntrests(userId);case 4:_context6.next=6;return this.filterUsers();case 6:case\"end\":return _context6.stop();}}},_callee6,this);}));function UNSAFE_componentWillMount(){return _UNSAFE_componentWillMount.apply(this,arguments);}return UNSAFE_componentWillMount;}()},{key:\"filterUsers\",value:function(){var _filterUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this2=this;var buffer,AgeMin,AgeMax,tmpbuff,fame,dist,tagss,tags,newbuffer;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:buffer=[];buffer=this.state.initialUsers;//FILTER\n//filter by age\nAgeMin=this.state.value[0];AgeMax=this.state.value[1];tmpbuff=[];buffer.forEach(function(user){if(user.age>=AgeMin&&user.age<=AgeMax){tmpbuff.push(user);}});buffer=tmpbuff;//filter by fame\nfame=this.state.rangeFame;tmpbuff=[];buffer.forEach(function(user){if(user.fame>=fame){tmpbuff.push(user);}});buffer=tmpbuff;//filter by dist\ndist=this.state.rangeLocalisation;tmpbuff=[];buffer.forEach(function(user){if(user.distance<=dist){tmpbuff.push(user);}});buffer=tmpbuff;//filter by interests\ntagss=[];tmpbuff=[];if(this.state.selectedOption!==null){this.state.selectedOption.forEach(function(element){tagss.push(element.value);});}if(tagss.length!==0){buffer.forEach(function(element){element.tags.forEach(function(tag){tagss.forEach(function(filter_tag){if(filter_tag===tag){tmpbuff.push(element);}});});});buffer=tmpbuff;}//SORT\n//sort by fame and age\nif(this.state.sortBy==='fame'||this.state.sortBy==='age'){buffer=sort(buffer).asc(function(u){return u[_this2.state.sortBy];});this.setState({userBuffer:buffer});//sort by distance\n}else if(this.state.sortBy==='location'){buffer=sort(buffer).asc(function(u){return u.distance;});this.setState({userBuffer:buffer});//sort by tags\n}else if(this.state.sortBy==='tags'){//on a une liste de tags.\n//on veut que les utilisateurs qui ont le premier element de la liste de tags arrive en premier puis les deuxieme arrive ensuite\ntags=[];if(this.state.interestsArray!==null){this.state.interestsArray.forEach(function(element){tags.push(element.value);});}newbuffer=[];tags.forEach(function(tagfromlist){buffer.forEach(function(element){element.tags.forEach(function(taguser){if(taguser===tagfromlist){newbuffer.push(element);}});});});buffer=newbuffer;this.setState({userBuffer:buffer});}case 20:case\"end\":return _context7.stop();}}},_callee7,this);}));function filterUsers(){return _filterUsers.apply(this,arguments);}return filterUsers;}()},{key:\"render\",value:function render(){var filteredUsers=this.state.userBuffer;return React.createElement(\"div\",null,React.createElement(\"form\",{style:{'marginBottom':'2rem'}},React.createElement(\"div\",{className:\"\",style:{display:'flex','justifyContent':'space-around'}},React.createElement(\"div\",{className:\"\",style:filterStyle},React.createElement(\"h4\",null,\"Age\"),React.createElement(\"p\",null,\"from \",this.state.value[0],\" to \",this.state.value[1]),React.createElement(Range,{allowCross:false,value:this.state.value,onChange:this.onSliderChange}),React.createElement(\"h4\",null,\"Fame\"),React.createElement(\"p\",null,\"search users above \",this.state.rangeFame,\" Fame\"),React.createElement(\"input\",{type:\"range\",className:\"custom-range\",id:\"rangeFame\",name:\"rangeFame\",min:\"0\",max:\"100\",value:this.state.rangeFame,onChange:this.onChange})),React.createElement(\"div\",{className:\"\",style:filterStyle},React.createElement(\"h4\",null,\"Localisation\"),React.createElement(\"p\",null,\"search users \",this.state.rangeLocalisation,\"km\",\"\".concat(this.state.rangeLocalisation>1?'s':''),\" from you\"),React.createElement(\"input\",{type:\"range\",className:\"custom-range\",id:\"rangeLocalisation\",name:\"rangeLocalisation\",min:\"1\",max:\"10000\",value:this.state.rangeLocalisation,onChange:this.onChange}),React.createElement(\"h4\",null,\"Interests\"),React.createElement(Select,{isMulti:true,isSearchable:true,placeholder:\"Filter interests\",value:this.state.selectedOption,onChange:this.handleSelectChange,options:this.state.interestsArray}))),React.createElement(\"div\",{style:{padding:'2rem'}},React.createElement(\"div\",{style:{backgroundColor:'grey',height:'2rem',display:'flex',justifyContent:'center',alignItems:'center'}},\" \",React.createElement(\"h4\",null,\"SORT BY\")),React.createElement(\"div\",{style:{backgroundColor:'grey',height:'5rem',display:'flex',justifyContent:'center',alignItems:'center'}},React.createElement(\"div\",{style:somemargin},React.createElement(\"div\",null,\"Age\"),React.createElement(\"input\",{type:\"radio\",name:\"sortBy\",value:\"age\",checked:this.state.sortBy==='age',onChange:this.onChange})),React.createElement(\"div\",{style:somemargin},React.createElement(\"div\",null,\"Distance\"),React.createElement(\"input\",{type:\"radio\",name:\"sortBy\",value:\"location\",checked:this.state.sortBy==='location',onChange:this.onChange})),React.createElement(\"div\",{style:somemargin},React.createElement(\"div\",null,\"Tags\"),React.createElement(\"input\",{type:\"radio\",name:\"sortBy\",value:\"tags\",checked:this.state.sortBy==='tags',onChange:this.onChange})),React.createElement(\"div\",{style:somemargin},React.createElement(\"div\",null,\"Fame\"),React.createElement(\"input\",{type:\"radio\",name:\"sortBy\",value:\"fame\",checked:this.state.sortBy==='fame',onChange:this.onChange}))))),React.createElement(ResultUser,{users:filteredUsers}));}}]);return SuggestionList;}(Component);var somemargin={textAlign:'center',width:'24%'};var filterStyle={width:'45%',float:'left',padding:'1rem','backgroundColor':'lightgray','marginTop':'2rem'};var state=function state(_state){var ownProps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return{getUserInterests:_state.getUserInterests.getUserInterests};};var mapDispatchToProps=function mapDispatchToProps(dispatch,ownProps){return{navigateTo:function navigateTo(location){dispatch(push(location));},onGetUserIntrests:function onGetUserIntrests(userId){return dispatch(GetUserIntrests(userId));}};};export default connect(state,mapDispatchToProps)(SuggestionList);","map":{"version":3,"sources":["/home/abn/my-projects/matcha-42/frontend/src/components/pages/Suggestion/SuggestionList.js"],"names":["React","Component","Range","Select","GetUserIntrests","connect","push","ResultUser","sort","SuggestionList","props","onLowerBoundChange","e","setState","lowerBound","target","value","onUpperBoundChange","upperBound","onSliderChange","filterUsers","handleApply","state","handleSelectChange","selectedOption","setTimeout","onChange","name","preventDefault","sortBy","SearchBar","rangeFame","rangeLocalisation","SearchBarTags","interestsArray","location","initialUsers","users","userBuffer","handleUsersFilter","bind","filter","userPos","age","interests","parseInt","onfetchAllUsersPublicData","userId","localStorage","getItem","onGetUserIntrests","buffer","AgeMin","AgeMax","tmpbuff","forEach","user","fame","dist","distance","tagss","element","length","tags","tag","filter_tag","asc","u","newbuffer","tagfromlist","taguser","filteredUsers","display","filterStyle","padding","backgroundColor","height","justifyContent","alignItems","somemargin","textAlign","width","float","ownProps","getUserInterests","mapDispatchToProps","dispatch","navigateTo"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Range } from 'rc-slider';\nimport Select from 'react-select';\nimport { GetUserIntrests } from '../../../store/actions/intrestsActions/GetAllInterestsAction';\nimport { connect } from \"react-redux\";\nimport { push } from \"react-router-redux\";\nimport ResultUser from './../Dashboard/ResultUser';\nimport sort from 'fast-sort';\n\nexport class SuggestionList extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            sortBy: 'age',\n            lowerBound: 18,\n            upperBound: 75,\n            value: [18, 75],\n            SearchBar: '',\n            rangeFame: 0,\n            rangeLocalisation: 10000,\n            SearchBarTags: '',\n            interestsArray: [],\n            selectedOption: [],\n            location: \"\",\n            initialUsers: this.props.users,\n            userBuffer: []\n        }\n\n        this.handleUsersFilter = this.handleUsersFilter.bind(this);\n        this.onChange = this.onChange.bind(this);\n        this.handleSelectChange = this.handleSelectChange.bind(this);\n    }\n\n\n    async handleUsersFilter(e) {\n        e.preventDefault();\n        let filter = [{\n            userPos: this.state.location,\n            rangeFame: this.state.rangeFame,\n            age: this.state.value,\n            interests: this.state.selectedOption,\n            rangeLocalisation: parseInt(this.state.rangeLocalisation)\n        }]\n\n        await this.props.onfetchAllUsersPublicData(filter);\n    }\n\n    onLowerBoundChange = (e) => {\n        this.setState({ lowerBound: +e.target.value });\n    }\n    onUpperBoundChange = (e) => {\n        this.setState({ upperBound: +e.target.value });\n    }\n    onSliderChange = async (value) => {\n        this.setState({\n            value,\n        });\n        await this.filterUsers();\n        // console.log(this.state.value);\n    }\n    handleApply = () => {\n        const { lowerBound, upperBound } = this.state;\n        this.setState({ value: [lowerBound, upperBound] });\n    }\n\n    handleSelectChange = selectedOption => {\n        this.setState(\n            { selectedOption },\n        );\n        setTimeout(async () => {\n            await this.filterUsers();\n        }, 50);\n    };\n\n    onChange = async (e) => {\n        if (e.target.name !== 'sortBy'){\n            e.preventDefault();\n        }         \n        this.setState({ [e.target.name]: e.target.value })\n\n        setTimeout(async () => {\n            await this.filterUsers();\n        }, 50);\n        // await this.filterUsers();\n        // console.log(this.state[e.target.name]);\n\n    }\n\n    async UNSAFE_componentWillMount() {\n        const userId = localStorage.getItem(\"userId\");\n        this.setState({interestsArray: this.props.interestsArray})\n        await this.props.onGetUserIntrests(userId);\n        await this.filterUsers();\n    }\n\n\n    async filterUsers () {\n\n        let buffer = [];\n        buffer = this.state.initialUsers;\n\n        //FILTER\n        //filter by age\n        var AgeMin = this.state.value[0];\n        var AgeMax = this.state.value[1];\n        var tmpbuff = [];\n        buffer.forEach(user => {\n            if (user.age >= AgeMin && user.age <= AgeMax){\n                tmpbuff.push(user);\n            }\n        });\n        buffer = tmpbuff;\n        //filter by fame\n        var fame = this.state.rangeFame;\n        var tmpbuff = [];\n        buffer.forEach(user => {\n            if (user.fame >= fame){\n                tmpbuff.push(user);\n            }\n        });\n        buffer = tmpbuff;\n        //filter by dist\n        var dist = this.state.rangeLocalisation;\n        var tmpbuff = [];\n        buffer.forEach(user => {\n            if (user.distance <= dist){\n                tmpbuff.push(user);\n            }\n        });\n        buffer = tmpbuff;\n        //filter by interests\n        var tagss = [];\n        var tmpbuff = [];\n        if (this.state.selectedOption !== null){\n            this.state.selectedOption.forEach(element => {\n                tagss.push(element.value);\n            });\n        }\n        if (tagss.length !== 0) {\n            buffer.forEach(element => {\n                element.tags.forEach(tag => {\n                    tagss.forEach(filter_tag => {\n                        if (filter_tag === tag){\n                            tmpbuff.push(element);\n                        }\n                    })\n                })\n            });\n            buffer = tmpbuff;\n        } \n\n        //SORT\n        //sort by fame and age\n        if (this.state.sortBy === 'fame' || this.state.sortBy === 'age'){\n            buffer = sort(buffer).asc(u => u[this.state.sortBy]);\n            this.setState({\n                userBuffer: buffer\n            })\n        //sort by distance\n        } else if(this.state.sortBy === 'location') {\n            buffer = sort(buffer).asc(u => u.distance);\n            this.setState({\n                userBuffer: buffer\n            })\n        //sort by tags\n        } else if (this.state.sortBy === 'tags') {\n            //on a une liste de tags.\n            //on veut que les utilisateurs qui ont le premier element de la liste de tags arrive en premier puis les deuxieme arrive ensuite\n            var tags = [];\n            if (this.state.interestsArray !== null){\n                this.state.interestsArray.forEach(element => {\n                    tags.push(element.value);\n                });\n            }\n            var newbuffer = [];\n            tags.forEach(tagfromlist => {\n                buffer.forEach(element => {\n                    element.tags.forEach(taguser => {\n                        if(taguser === tagfromlist) {\n                            newbuffer.push(element);\n                        }\n                    });\n                });\n            });\n            buffer = newbuffer;\n            this.setState({\n                userBuffer: buffer\n            })\n        }\n    }\n\n    render() {\n\n        let filteredUsers = this.state.userBuffer;\n\n        return (\n            <div>\n                <form style={{ 'marginBottom': '2rem' }}>\n                <div className=\"\" style={{ display: 'flex', 'justifyContent': 'space-around' }}>\n                    <div className=\"\" style={filterStyle}>\n                        <h4>Age</h4>\n                        <p>from {this.state.value[0]} to {this.state.value[1]}</p>\n                        {/* <p>from {this.state.rangeAgeFrom} years old</p>\n                        <input type=\"range\" className=\"custom-range\" id=\"rangeAgeFrom\" name=\"rangeAgeFrom\" min=\"18\" max=\"79\" value={this.state.rangeAgeFrom} onChange={this.onChange} />\n                        <p>to {this.state.rangeAgeTo} years old</p>\n                        <input type=\"range\" className=\"custom-range\" id=\"rangeAgeTo\" name=\"rangeAgeTo\" min=\"19\" max=\"80\" value={this.state.rangeAgeTo} onChange={this.onChange} /> */}\n                        <Range allowCross={false} value={this.state.value} onChange={this.onSliderChange} />\n\n                        <h4>Fame</h4>\n                        <p>search users above {this.state.rangeFame} Fame</p>\n                        <input type=\"range\" className=\"custom-range\" id=\"rangeFame\" name=\"rangeFame\" min=\"0\" max=\"100\" value={this.state.rangeFame} onChange={this.onChange} />\n                    </div>\n                    <div className=\"\" style={filterStyle}>\n                        <h4>Localisation</h4>\n                        <p>search users {this.state.rangeLocalisation}km{`${this.state.rangeLocalisation > 1 ? 's' : ''}`} from you</p>\n                        <input type=\"range\" className=\"custom-range\" id=\"rangeLocalisation\" name=\"rangeLocalisation\" min=\"1\" max=\"10000\" value={this.state.rangeLocalisation} onChange={this.onChange} />\n                        <h4>Interests</h4>\n                            <Select\n                                isMulti\n                                isSearchable\n                                placeholder=\"Filter interests\"\n                                value={this.state.selectedOption}\n                                onChange={this.handleSelectChange}\n                                options={this.state.interestsArray}\n                            />\n                    </div>\n                </div>\n                <div style={{ padding: '2rem'}}>\n                    <div style={{backgroundColor: 'grey', height: '2rem', display: 'flex', justifyContent: 'center', alignItems: 'center'}}> <h4>SORT BY</h4></div>\n                    <div style={{backgroundColor: 'grey', height: '5rem', display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\n                        <div style={somemargin}>\n                            <div>Age</div>\n                            <input type=\"radio\" name=\"sortBy\" value=\"age\" checked={this.state.sortBy === 'age'} onChange={this.onChange}/>\n                        </div>\n                        <div style={somemargin}>\n                            <div>Distance</div>\n                            <input type=\"radio\" name=\"sortBy\" value=\"location\" checked={this.state.sortBy === 'location'} onChange={this.onChange}/>\n                        </div>\n                        <div style={somemargin}>\n                            <div>Tags</div>\n                            <input type=\"radio\" name=\"sortBy\" value=\"tags\" checked={this.state.sortBy === 'tags'} onChange={this.onChange}/>\n                        </div>\n                        <div style={somemargin}>\n                            <div>Fame</div>\n                            <input type=\"radio\" name=\"sortBy\" value=\"fame\" checked={this.state.sortBy === 'fame'} onChange={this.onChange}/>\n                        </div>\n                    </div>\n                    \n                </div>\n            </form>\n            <ResultUser users={filteredUsers}/>\n            </div>\n            \n        )\n    }\n}\n\nconst somemargin = { textAlign: 'center', width: '24%'}\n\nconst filterStyle = {\n    width: '45%',\n    float: 'left',\n    padding: '1rem',\n    'backgroundColor': 'lightgray',\n    'marginTop': '2rem'\n};\n\nconst state = (state, ownProps = {}) => {\n    return {\n        getUserInterests: state.getUserInterests.getUserInterests\n    }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n    return {\n        navigateTo: (location) => {\n            dispatch(push(location));\n        },\n        onGetUserIntrests: (userId) => dispatch(GetUserIntrests(userId))\n    }\n};\n\nexport default connect(\n    state,\n    mapDispatchToProps\n)(SuggestionList);\n"]},"metadata":{},"sourceType":"module"}